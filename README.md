# AstrBot AI日记插件 (astrbot_plugin_diary)

"嘘，这是只有我们知道的秘密。"

给你的AstrBot装上这个小插件，让AI每天都偷偷写下关于你们的日记。它会读取当天的聊天记录，然后用它自己的口吻、性格和情感，写出一篇完全专属于你的回忆录。

## 食用指南

对机器人使用下面的指令：

- `/今日日记` : 召唤日记本！它会立刻开始提笔总结今天的故事。
- `/查看日记列表` : 看看这小家伙到底背着你写了多少天的日记。
- `/阅读日记 [日期]` : 比如 `/阅读日记 2023-10-27`，翻开曾经的记录回顾一下。
- `/删除日记 [日期或all]` : 销毁黑历史专用指令。可以删掉某一天的，或者用 all 把当前角色的日记烧得干干净净。

## 它有什么特别的？

- 绝不串戏：日记本是和“你”以及“当前AI人格”绑定的，别人偷看不到，换个人格也是一个全新的开始。
- 情感拉满：按照要求，心情波动时会通过 Markdown 表现出来：羞耻的内容会划掉删去，暗黑的想法会加重黑体，重要的事情它总是记得清清楚楚。
- 随心定制：可以自定义提示词和回复语。
- 数据直接保存在机器人的根目录里，就算插件重装，属于你们的记忆也绝对不会弄丢。

## 环境依赖 (必读)

为了让“在线日记本 (WebUI)”能够通过 MQTT 协议与网页端进行安全的数据通信，本插件依赖于 `paho-mqtt` 和 `pycryptodome` 库。
如果未安装这两个库，基础的文字日记依然可用，但 `/查看日记本` 的网页端链接功能将被禁用。

### 💻 普遍环境安装 (Windows / Linux / Mac)

如果你是直接在系统宿主机运行的 AstrBot，进入你的虚拟环境执行：

```bash
pip install -r requirements.txt
```

或者手动执行：

```bash
pip install paho-mqtt pycryptodome
```

### 🐳 Docker 环境安装指南 (给使用 Docker 部署的主人们)

因为 Docker 环境是将程序隔离在一个容器里的，所以**千万不能**直接跑在系统主机的命令行里。你需要进入跑着 AstrBot 的内部去安装它。

**第一步：进入跑着 AstrBot 的 Docker 容器内部**

```bash
docker exec -it astrbot /bin/bash
```

_(注意：上面命令里的 `astrbot` 是你启动容器时起的名字（Container Name）。如果你不确定，可以先运行 `docker ps` 查看你的 AstrBot 容器名叫什么，然后替换掉即可。)_

**第二步：在容器内部执行安装指令**
进去之后，控制台前缀会发生变化，此时直接贴入并执行：

```bash
pip install paho-mqtt pycryptodome
```

等到出现 `Successfully installed ...` 字样后，输入 `exit` 回车退出来。

**第三步：重启容器应用生效**

```bash
docker restart astrbot
```

大功告成！现在对你的机器人发送 `/查看日记本` 试试跨平台的安全日记本吧！
